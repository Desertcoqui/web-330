<!-- // Title: WhatABook Part 1
// Author: Professor Kumar
// Modified by: Ferdinand Detres
// Date: July 8 2022
// Description: Book that uses XMl to fetch data
https://financeformulas.net/Future_Value.html
https://financeformulas.net/Future_Value.html
https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/NumberFormat

-->

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>WEB 330 - Enterprise JavaScript II</title>

    <!-- css -->

    <link rel="stylesheet" type="text/css" href="../site.css" />
    <link rel="stylesheet" type="text/css" href="../theme.css" />
    <link rel="stylesheet" type="text/css" href="detres-future-value.css" />
    <link rel="stylesheet" type="text/css" href="flex-layout.css" />



    <!-- font links -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@300;400;500;700&display=swap" rel="stylesheet">

    <!-- scripts -->
    <script src="../theme.js"></script>
</head>

<div class="light-theme">
    <i onclick="toggleMode(this)" id="icon-mode" class="fa fa-toggle-off pull-right" style="font-size: 28px"><span
            id="icon-text"></span></i>
    <!-- Assignment Container -->
    <div class="assign-container">
        <h1 class="app-header">Welcome to the Future Value App!</h1>
        <div class="assign-content">
            <div class="card">
                <div class="card-title">Future Value Calculator</div>
                <div class="card-content">
                    <div class="form">
                        <!-- Display Error Here Else Empty -->
                        <div id="errorLog" class="row col-12 danger"> </div>

                        <!-- BEGIN Inputs and Labels -->
                        <div class=" form-label row">
                            <label class="col-5" for="txtMonthlyPayment">Monthly Payment:</label>
                            <input type="text" class="input col-7" id="txtMonthlyPayment" name="monthly payment" />
                        </div>
                        <div class=" form-label row">
                            <label class="col-5" for="txtYearlyRate">Interest Rate:</label>
                            <input type="text" class="input col-7" id="txtYearlyRate" name="Interest Rate" />
                            <span> <i class="danger">Enter 11% as 11.1:</i></span>
                        </div>

                        <div class=" form-label row">
                            <label class="col-5" for="txtMonthlyPayment">Number of Years: </label>
                            <select id="listNumOfYears" class="drop-down-menu col-2">

                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                                <option value="7">7</option>
                                <option value="8">8</option>
                                <option value="9">9</option>
                                <option value="10">10</option>

                            </select>
                        </div>
                        <!-- END Labels and Inputs -->
                        <div class="form-field">
                            <button id="btnCalculate" class="btn btn-primary full-width">Calculate</button>
                        </div>
                    </div>
                </div>
            </div>
            <a class="return-home" href="../index.html">Return</a>
        </div>
        <!-- End Assignment Container -->

        <!-- Results Container -->
        <div class="assign-container">
            <div class="assign-content">
                <div class="card">
                    <div class="card-title">Calculation as of <span id="today"></span></div>
                    <div class="card-content assign-results-text" id="futureValue"></div>
                </div>
            </div>
        </div>
        <!-- End Results Container   -->
    </div>










    <script type='module'>
        // imports
        setDefaultTheme();
        import {FinanceCalculator} from "./finance-calculator.js";
        import {Validator} from "./validator.js"

        document.getElementById("today").innerHTML=new Date().toLocaleDateString("en-US");

        document.getElementById("btnCalculate").onclick=function() {
            //Variables assigned to html IDs
            let monthlyPayment=document.getElementById("txtMonthlyPayment").value;
            let rate=document.getElementById("txtYearlyRate").value;
            let years=document.getElementById("listNumOfYears").value;
            let errorLogEl=document.getElementById("errorLog");

            //instantiating new Validator class assigned to new variable
            let monthlyPaymentValidator=new Validator("Monthly Payment",monthlyPayment);

            monthlyPaymentValidator.addRequiredField();
            monthlyPaymentValidator.addRequiredFloatField();
            monthlyPaymentValidator.addFloatMinField(100);

            //instantiating new Validator class assigned to new variable
            let rateValidator=new Validator("Interest Rate",rate);

            rateValidator.addRequiredField();
            rateValidator.addRequiredFloatField();
            rateValidator.addFloatMaxField(100);

            //empty array which will display pushed error messages from if/else statements below
            let errorLog=[];


            if(!monthlyPaymentValidator.validate()) {
                for(let msg of monthlyPaymentValidator.messages) {
                    errorLog.push(msg);
                }
            }


            if(!rateValidator.validate()) {
                for(let msg of rateValidator.messages) {
                    errorLog.push(msg);
                }
            }

            //if both validators are true html is cleared
            if(monthlyPaymentValidator.validate()&&rateValidator.validate()) {

                errorLogEl.innerHTML="";
                //calls static variables created in FinanceCalculator class
                let futureValue=FinanceCalculator.calculateFutureValue(monthlyPayment,rate,years);
                //binded html values
                document.getElementById("futureValue").innerHTML="The future value is "+FinanceCalculator.convertToCurrency(futureValue);
            }

            else {
                errorLogEl.innerHTML="";
                let errorLogMessage=`<ul>`;
                for(let msg of errorLog) {
                    errorLogMessage+=`<li>${msg}</li>`;
                }
                document.getElementById("errorLog").innerHTML=errorLogMessage+`</ul>`;
            }
        };


        toggleMode();
    </script>

    </body>

</html>